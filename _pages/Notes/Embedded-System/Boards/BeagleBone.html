<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <!-- <title>BeagleBone &mdash; RDU-Wiki 1.0 documentation</title> -->
    <title>BeagleBone</title>
    
    <link rel="stylesheet" href="../../../../_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link href='http://fonts.googleapis.com/css?family=Dancing+Script:700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Courgette' rel='stylesheet' type='text/css'>
    
    <div class="rduhome"  role="contentinfo">
		 <a href="http://rdu.im" style="font-family: 'Courgette', serif;" >Return to Ruixiang's Home Page</a>
	</div>
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="top" title="RDU-Wiki 1.0 documentation" href="../../../../index.html" />
    <link rel="up" title="Application Notes" href="../../Application-Notes.html" />
    <link rel="next" title="Raspberry Pi" href="Raspberry-Pi.html" />
    <link rel="prev" title="Application Notes" href="../../Application-Notes.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../../../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Raspberry-Pi.html" title="Raspberry Pi"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../Application-Notes.html" title="Application Notes"
             accesskey="P">previous</a> |</li>
        <!-- <li class="nav-item nav-item-0"><a href="../../../../index.html">RDU-Wiki 1.0 documentation</a> &raquo;</li> -->
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Main Page</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../Application-Notes.html" accesskey="U">Application Notes</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="beaglebone">
<h1>BeagleBone<a class="headerlink" href="#beaglebone" title="Permalink to this headline">¶</a></h1>
<div class="section" id="flash-the-emmc">
<h2>Flash the eMMC<a class="headerlink" href="#flash-the-emmc" title="Permalink to this headline">¶</a></h2>
<p>Follow reference [1] to flash the OS to the eMMC storage. A brief summary:</p>
<ul class="simple">
<li>Download image and extract the .img file</li>
<li>Create a bootable SD card with the image (using tools such as etcher)</li>
<li>Boot into the OS on the SD card (holding the SD button and then power up the board)</li>
<li>Modify “/boot/uEnv.txt” and uncomment the line that enables the flasher</li>
<li>Shutdown the board and boot from the SD again, wait until the eMMC is flashed with the system</li>
</ul>
<p>You can login to the system after the board boots up</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ssh debian@192.168.7.2 <span class="c1"># default password: temppwd</span>
</pre></div>
</div>
</div>
<div class="section" id="add-new-user">
<h2>Add new user<a class="headerlink" href="#add-new-user" title="Permalink to this headline">¶</a></h2>
<p>Now you can add your own account and delete the default one</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo adduser --ingroup users &lt;USERNAME&gt;
$ sudo adduser &lt;YOUR_USERNAME&gt; sudo
$ <span class="nb">logout</span>
$ sudo deluser --remove-home user
</pre></div>
</div>
</div>
<div class="section" id="setup-wifi">
<h2>Setup Wifi<a class="headerlink" href="#setup-wifi" title="Permalink to this headline">¶</a></h2>
<p>You can use “connman” to manage the wireless network. But I personally prefer using the old way.</p>
<ul class="simple">
<li>Disable connman</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ systemctl disable connman.service
</pre></div>
</div>
<ul class="simple">
<li>Generate WPA passphrase for your WiFi</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ wpa_passphrase &lt;ssid&gt; &lt;password&gt;
</pre></div>
</div>
<ul class="simple">
<li>Update /etc/network/interfaces</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo nano /etc/network/interfaces
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># interfaces(5) file used by ifup(8) and ifdown(8)</span>
auto lo
iface lo inet loopback

auto wlan0
iface wlan0 inet dhcp
    wpa-ssid ExampleWifi
    wpa-psk &lt;wpa-psk-generated-by-wpa-passphrase-command&gt;
</pre></div>
</div>
</div>
<div class="section" id="mount-usr-and-home-on-sd-card">
<h2>Mount “/usr” and “/home” on SD card<a class="headerlink" href="#mount-usr-and-home-on-sd-card" title="Permalink to this headline">¶</a></h2>
<p>The BeagleBone Blue has 4G on-board eMMC flash storage. It could be enough for many applications. But for experimental projects, it’s more convenient to have more space so that you don’t need to worry too much about filling the eMMC flash up when installing new packages.</p>
<p>Check reference [2] to get more detailed instructions. Here is a brief summary of what you need to do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. format your SD card into two partitions</span>
<span class="c1"># 2. insert the SD card and power up the board</span>
<span class="c1"># 3. check if you have the two partitions on the SD card recognized by the OS correctly</span>
$ fdisk -l
<span class="c1"># (the two partitions are labeled as &quot;/dev/mmcblk0p1&quot; and &quot;/dev/mmcblk0p2&quot; on my board)</span>
<span class="c1"># 4. format the two partions as ext4</span>
$ mkfs.ext4 /dev/mmcblk0p1
$ mkfs.ext4 /dev/mmcblk0p2
<span class="c1"># 5. create temporary folders in /tmp and mount the two partitions to the temporary folders, copy files from /usr and /home accordingly</span>
$ sudo mkdir /tmp/usr
$ sudo mkdir /tmp/home
$ sudo mount /dev/mmcblk0p1 /tmp/usr
$ sudo mount /dev/mmcblk0p2 /tmp/home
$ sudo rsync -ahv --progress /usr/ /tmp/usr/
$ sudo rsync -ahv --progress /home/ /tmp/home/
<span class="c1"># 6. update /etc/fstab to reflect the change</span>
$ sudo lsblk -no UUID /dev/mmcblk0p1 <span class="c1"># get UUID of /dev/mmcblk0p1</span>
<span class="c1"># add two lines in /etc/fstab</span>
$ <span class="nv">UUID</span><span class="o">=</span>&lt;ID-YOU-GOT-FROM-ABOVE-CMD&gt; /usr ext4    defaults <span class="m">0</span> <span class="m">1</span>
$ <span class="nv">UUID</span><span class="o">=</span>&lt;ID-YOU-GOT-FROM-ABOVE-CMD&gt; /home ext4    defaults <span class="m">0</span> <span class="m">1</span>
or
$ /dev/mmcblk0p1 /usr ext4 defaults <span class="m">0</span> <span class="m">1</span>
$ /dev/mmcblk0p2 /home ext4 defaults <span class="m">0</span> <span class="m">1</span>
<span class="c1"># 7. reboot and check the files</span>
$ df -h
</pre></div>
</div>
</div>
<div class="section" id="add-a-swap-file">
<h2>Add a Swap File<a class="headerlink" href="#add-a-swap-file" title="Permalink to this headline">¶</a></h2>
<p>Sometimes a swap area may be needed to compile a large project on beaglebone black. Instead of setting up a swap partition, you can also use a swap file.</p>
<p>In the following steps, a swap file “/usr/swapfile1” will be created and used.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Create Storage File</span>
$ sudo dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>/usr/swapfile1 <span class="nv">bs</span><span class="o">=</span><span class="m">1024</span> <span class="nv">count</span><span class="o">=</span><span class="m">524288</span>
<span class="c1"># 2. Secure swap file</span>
$ sudo chown root:root /usr/swapfile1
$ sudo chmod <span class="m">0600</span> /usr/swapfile1
<span class="c1"># 3. Set up a Linux swap area and enable the swap file</span>
$ sudo mkswap /usr/swapfile1
$ sudo swapon /usr/swapfile1
<span class="c1"># 4. Update /etc/fstab file</span>
$ sudo nano /etc/fstab
<span class="c1"># Add the following line</span>
/usr/swapfile1 none swap sw <span class="m">0</span> <span class="m">0</span>
</pre></div>
</div>
<p>Reboot the board and use htop to check if the swap file is set up correctly.</p>
</div>
<div class="section" id="update-kernel">
<h2>Update Kernel<a class="headerlink" href="#update-kernel" title="Permalink to this headline">¶</a></h2>
<p>You can upgrade or change to a Preempt-RT patched kernel using the script provided in the Debian OS from Beaglebone</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /opt/scripts/tools
$ git pull   <span class="c1"># you may need to use sudo here</span>
$ sudo /opt/scripts/tools/update_kernel.sh --bone-rt-channel --lts-4_4   <span class="c1"># --lts-stable or other available options</span>
</pre></div>
</div>
<p>Refer to [5] for additiona options.</p>
<p>Note that if you use the kernel from TI channel (for example, use “–ti-rt-channel” option), you might experience errors related to the PINMUX helper driver.</p>
</div>
<div class="section" id="robotics-cape-library">
<h2>Robotics Cape library<a class="headerlink" href="#robotics-cape-library" title="Permalink to this headline">¶</a></h2>
<p>TI channel kernels have more complete support to PRU drivers so you may want to use a kernel from the TI channel if you’re using the Robotics Cape or Beaglebone Blue.[7]</p>
<p>When using the TI channel RT kernel 4.4 and 4.9 on Beaglebone Blue with the Robotics Cape library, I got the following error message from the library:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>...
can&#39;t open: /sys/devices/platform/ocp/ocp:P9_24_pinmux/state
Pinmux: No such file or directory
WARNING: missing PINMUX driver
You probbaly just need a newer kernel
</pre></div>
</div>
<p>I’m not sure if this will happen to other boards or how to install this pinmux helper driver manually for the TI channel kernels. I resolved this issue by switching to a bone channel kernel.</p>
<p>The other issue related to the Robotics Cape library that occured even after installing the bone channel RT kernel is on the pru-rproc driver, which gives the error message</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ERROR: pru-rproc driver missing
</pre></div>
</div>
<p>The solution is to add a symbolic link of clpru executable to /usr/share/ti/cgt-pru/bin folder:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /usr/share/ti/cgt-pru
mkdir bin
<span class="nb">cd</span> bin
ln -s /usr/bin/clpru clpru
</pre></div>
</div>
<p>See [6] for more discussions on this issue and the above solution is from this page.</p>
<p>Reference</p>
<ul class="simple">
<li>[1] <a class="reference external" href="https://github.com/beagleboard/beaglebone-blue/wiki/Flashing-firmware">https://github.com/beagleboard/beaglebone-blue/wiki/Flashing-firmware</a></li>
<li>[2] <a class="reference external" href="https://gist.github.com/rxdu/35fb70c71cde5b44815e52bd8c338ff3">https://gist.github.com/rxdu/35fb70c71cde5b44815e52bd8c338ff3</a></li>
<li>[3] <a class="reference external" href="http://xeikonmirkwood.blogspot.com/2014/05/connman-is-annoying.html">http://xeikonmirkwood.blogspot.com/2014/05/connman-is-annoying.html</a></li>
<li>[4] <a class="reference external" href="http://pdkb.azurewebsites.net/Home/Detail/installing-can-bus-drivers-for-osd3358-systems-running-debian">http://pdkb.azurewebsites.net/Home/Detail/installing-can-bus-drivers-for-osd3358-systems-running-debian</a></li>
<li>[5] <a class="reference external" href="https://github.com/beagleboard/bb.org-overlays">https://github.com/beagleboard/bb.org-overlays</a></li>
<li>[6] <a class="reference external" href="https://groups.google.com/forum/#!topic/beagleboard/od6h9yTKUD4">https://groups.google.com/forum/#!topic/beagleboard/od6h9yTKUD4</a></li>
<li>[7] <a class="reference external" href="https://github.com/StrawsonDesign/librobotcontrol/issues/130">https://github.com/StrawsonDesign/librobotcontrol/issues/130</a></li>
<li>[8] <a class="reference external" href="https://www.cyberciti.biz/faq/linux-add-a-swap-file-howto/">https://www.cyberciti.biz/faq/linux-add-a-swap-file-howto/</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">BeagleBone</a><ul>
<li><a class="reference internal" href="#flash-the-emmc">Flash the eMMC</a></li>
<li><a class="reference internal" href="#add-new-user">Add new user</a></li>
<li><a class="reference internal" href="#setup-wifi">Setup Wifi</a></li>
<li><a class="reference internal" href="#mount-usr-and-home-on-sd-card">Mount “/usr” and “/home” on SD card</a></li>
<li><a class="reference internal" href="#add-a-swap-file">Add a Swap File</a></li>
<li><a class="reference internal" href="#update-kernel">Update Kernel</a></li>
<li><a class="reference internal" href="#robotics-cape-library">Robotics Cape library</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../../Application-Notes.html"
                        title="previous chapter">Application Notes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Raspberry-Pi.html"
                        title="next chapter">Raspberry Pi</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Raspberry-Pi.html" title="Raspberry Pi"
             >next</a> |</li>
        <li class="right" >
          <a href="../../Application-Notes.html" title="Application Notes"
             >previous</a> |</li>
        <!-- <li class="nav-item nav-item-0"><a href="../../../../index.html">RDU-Wiki 1.0 documentation</a> &raquo;</li> -->
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Main Page</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../Application-Notes.html" >Application Notes</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2020, Ruixiang Du.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>